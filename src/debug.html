<!DOCTYPE html>
<html>
<head>
    <title>Profile Debug Test</title>
</head>
<body>
    <h1>Profile System Debug Test</h1>
    <div id="output"></div>
    <button onclick="testProfiles()">Test Profile Loading</button>
    <button onclick="createTestProfile()">Create Test Profile</button>

    <script type="module">
        import { invoke } from '@tauri-apps/api/core';

        window.testProfiles = async function() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>Testing profile loading...</p>';
            
            try {
                console.log('üîç Debug: Calling get_all_profiles...');
                const profiles = await invoke('get_all_profiles');
                console.log('‚úÖ Debug: Profiles received:', profiles);
                output.innerHTML = `<p>‚úÖ Success! Found ${profiles.length} profiles:</p><pre>${JSON.stringify(profiles, null, 2)}</pre>`;
            } catch (error) {
                console.error('‚ùå Debug: Error:', error);
                output.innerHTML = `<p>‚ùå Error: ${error}</p>`;
            }
        };

        window.createTestProfile = async function() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>Creating test profile...</p>';
            
            try {
                const request = {
                    name: 'Debug Test Child',
                    avatar: 'üß™',
                    theme_preference: 'default'
                };
                
                console.log('üîç Debug: Creating profile with:', request);
                const profile = await invoke('create_profile', { request });
                console.log('‚úÖ Debug: Profile created:', profile);
                output.innerHTML = `<p>‚úÖ Profile created successfully!</p><pre>${JSON.stringify(profile, null, 2)}</pre>`;
            } catch (error) {
                console.error('‚ùå Debug: Error creating profile:', error);
                output.innerHTML = `<p>‚ùå Error creating profile: ${error}</p>`;
            }
        };

        // Auto-test on load
        window.addEventListener('load', () => {
            setTimeout(testProfiles, 1000);
        });
    </script>
</body>
</html>